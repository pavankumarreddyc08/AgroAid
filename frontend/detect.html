<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Detect Disease - AgroAid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <!-- GLASS NAVBAR -->
    <nav class="glass-navbar fixed-top">
      <div class="container">
        <div class="nav-content">
          <a class="brand" href="index.html">
            <div class="brand-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M12 2L2 7l10 5 10-5-10-5z" />
                <path d="M2 17l10 5 10-5" />
                <path d="M2 12l10 5 10-5" />
              </svg>
            </div>
            <span>AgroAid</span>
          </a>

          <button class="mobile-toggle" type="button" id="mobileToggle">
            <span></span>
            <span></span>
            <span></span>
          </button>

          <div class="nav-menu" id="navMenu">
            <a class="nav-link" href="index.html">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                <polyline points="9 22 9 12 15 12 15 22" />
              </svg>
              <span>Home</span>
            </a>

            <a class="nav-link active" href="detect.html">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="11" cy="11" r="8" />
                <path d="m21 21-4.3-4.3" />
              </svg>
              <span>Detect</span>
            </a>

            <a
              class="nav-link"
              href="dashboard.html"
              id="dashboardNav"
              style="display: none"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <rect width="7" height="9" x="3" y="3" rx="1" />
                <rect width="7" height="5" x="14" y="3" rx="1" />
                <rect width="7" height="9" x="14" y="12" rx="1" />
                <rect width="7" height="5" x="3" y="16" rx="1" />
              </svg>
              <span>Dashboard</span>
            </a>

            <div class="nav-auth" id="authArea">
              <a class="btn-glass" href="auth.html">
                <span>Login</span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                  <polyline points="10 17 15 12 10 7" />
                  <line x1="15" x2="3" y1="12" y2="12" />
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <!-- Language Selector -->
      <div class="language-selector">
        <button class="btn-language" id="languageBtn">
          <svg>...</svg>
          <span id="currentLang">EN</span>
        </button>
        <div class="language-dropdown" id="languageDropdown">
          <button class="lang-option" onclick="changeLanguage('en')">
            <span class="flag">üá∫üá∏</span>
            <span>English</span>
          </button>
          <!-- More languages... -->
        </div>
      </div>
    </nav>

    <!-- MAIN SECTION -->
    <div class="detect-container">
      <div class="container">
        <div class="detect-header">
          <div class="detect-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="40"
              height="40"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.3-4.3" />
            </svg>
          </div>
          <h2>Fruit Disease Detection</h2>
          <p>Upload a leaf image and let AI identify potential diseases</p>
        </div>

        <!-- Fruit Selection -->
        <div class="glass-card mb-4">
          <label class="input-label">Select Fruit Type</label>
          <select class="glass-select" id="fruitSelect">
            <option value="">Choose your fruit</option>
            <option value="guava">üçà Guava</option>
            <option value="banana">üçå Banana</option>
            <option value="mango">ü•≠ Mango</option>
          </select>
        </div>

        <!-- Upload Box -->
        <div class="upload-box-modern" id="uploadBox">
          <div class="upload-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
              <polyline points="17 8 12 3 7 8" />
              <line x1="12" x2="12" y1="3" y2="15" />
            </svg>
          </div>
          <h3>Drag & Drop Image Here</h3>
          <p>or click to browse from your device</p>
          <input type="file" id="imageInput" hidden accept="image/*" />
          <button
            class="btn-upload"
            onclick="document.getElementById('imageInput').click()"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"
              />
              <circle cx="12" cy="13" r="3" />
            </svg>
            <span>Choose Image</span>
          </button>
        </div>

        <!-- Image Preview -->
        <div
          class="preview-container"
          id="previewContainer"
          style="display: none"
        >
          <div class="glass-card">
            <div class="preview-header">
              <h4>Uploaded Image</h4>
              <button class="btn-remove" onclick="removeImage()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M18 6 6 18" />
                  <path d="m6 6 12 12" />
                </svg>
                Remove
              </button>
            </div>
            <img id="previewImage" class="preview-image" />
          </div>
        </div>

        <!-- Detect Button -->
        <div class="text-center my-4">
          <button class="btn-detect" onclick="detectDisease()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
            </svg>
            <span>Analyze with AI</span>
          </button>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-container" id="loading" style="display: none">
          <div class="loading-spinner"></div>
          <p>AI is analyzing your image...</p>
          <div class="loading-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>

        <!-- RESULT SECTION -->
        <div class="result-container" id="resultSection" style="display: none">
          <div class="glass-card result-card">
            <div class="result-header">
              <div class="result-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="20 6 9 17 4 12" />
                </svg>
              </div>
              <h3>Detection Complete</h3>
            </div>

            <div class="result-item">
              <div class="result-label">Detected Disease</div>
              <div class="result-value disease-name" id="diseaseName">-</div>
            </div>

            <div class="result-item">
              <div class="result-label">Confidence Level</div>
              <div class="confidence-container">
                <div class="confidence-bar-bg">
                  <div id="confidenceBar" class="confidence-bar"></div>
                </div>
                <div class="confidence-text" id="confidenceText">0%</div>
              </div>
            </div>

            <div class="result-item">
              <div class="result-label">Risk Assessment</div>
              <div class="risk-badge-container">
                <span id="riskLevel" class="risk-badge">-</span>
              </div>
            </div>

            <div class="result-item treatment-section">
              <div class="treatment-header">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
                  />
                </svg>
                <span>Treatment Recommendations</span>
              </div>
              <p id="treatmentText" class="treatment-text">-</p>
            </div>

            <div class="result-actions">
              <button class="btn-new-scan" onclick="newScan()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8" />
                  <path d="M21 3v5h-5" />
                </svg>
                New Scan
              </button>
              <a href="dashboard.html" class="btn-view-history">
                View History
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="js/main.js"></script>
    <script src="js/detect.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      if (!localStorage.getItem("loggedInUser")) {
        alert("Please login to access detection feature!");
        window.location.href = "auth.html";
      }
    </script>

    <style>
      /* Additional Detect Page Styles */
      .detect-container {
        min-height: 100vh;
        padding: 120px 0 80px;
      }

      .detect-header {
        text-align: center;
        margin-bottom: 48px;
      }

      .detect-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 24px;
        background: rgba(255, 255, 255, 0.12);
        backdrop-filter: blur(10px);
        border-radius: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .detect-header h2 {
        font-size: 2.5rem;
        font-weight: 800;
        color: white;
        margin-bottom: 12px;
      }

      .detect-header p {
        font-size: 1.125rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .glass-card {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 24px;
        padding: 32px;
      }

      .input-label {
        display: block;
        color: white;
        font-weight: 600;
        font-size: 1rem;
        margin-bottom: 12px;
      }

      .glass-select {
        width: 100%;
        padding: 16px 20px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px;
        color: white;
        font-size: 1rem;
        outline: none;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .glass-select:focus {
        background: rgba(255, 255, 255, 0.12);
        border-color: rgba(255, 255, 255, 0.4);
      }

      .glass-select option {
        background: #1f2937;
        color: white;
      }

      .upload-box-modern {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border: 2px dashed rgba(255, 255, 255, 0.3);
        border-radius: 24px;
        padding: 60px 40px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .upload-box-modern:hover {
        background: rgba(255, 255, 255, 0.12);
        border-color: rgba(255, 255, 255, 0.5);
        transform: translateY(-4px);
      }

      .upload-icon {
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 24px;
      }

      .upload-box-modern h3 {
        color: white;
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 8px;
      }

      .upload-box-modern p {
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 24px;
      }

      .btn-upload {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 14px 32px;
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 14px;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-upload:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-2px);
      }

      .preview-container {
        margin: 32px 0;
      }

      .preview-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .preview-header h4 {
        color: white;
        font-weight: 700;
        margin: 0;
      }

      .btn-remove {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        background: rgba(239, 68, 68, 0.2);
        border: 1px solid rgba(239, 68, 68, 0.3);
        border-radius: 10px;
        color: #ef4444;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-remove:hover {
        background: rgba(239, 68, 68, 0.3);
      }

      .preview-image {
        width: 100%;
        max-height: 400px;
        object-fit: contain;
        border-radius: 16px;
      }

      .btn-detect {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 18px 48px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 16px;
        color: white;
        font-weight: 700;
        font-size: 1.125rem;
        cursor: pointer;
        transition: all 0.4s ease;
        box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4);
      }

      .btn-detect:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 60px rgba(102, 126, 234, 0.6);
      }

      .loading-container {
        text-align: center;
        padding: 60px 40px;
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 24px;
      }

      .loading-spinner {
        width: 60px;
        height: 60px;
        margin: 0 auto 24px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .loading-container p {
        color: white;
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 16px;
      }

      .loading-dots {
        display: flex;
        justify-content: center;
        gap: 8px;
      }

      .loading-dots span {
        width: 8px;
        height: 8px;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        animation: bounce 1.4s ease-in-out infinite both;
      }

      .loading-dots span:nth-child(1) {
        animation-delay: -0.32s;
      }
      .loading-dots span:nth-child(2) {
        animation-delay: -0.16s;
      }

      @keyframes bounce {
        0%,
        80%,
        100% {
          transform: scale(0);
        }
        40% {
          transform: scale(1);
        }
      }

      .result-container {
        margin-top: 32px;
      }

      .result-card {
        padding: 48px;
      }

      .result-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 32px;
        padding-bottom: 24px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .result-icon {
        width: 64px;
        height: 64px;
        background: rgba(16, 185, 129, 0.2);
        border: 2px solid rgba(16, 185, 129, 0.4);
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #10b981;
      }

      .result-header h3 {
        color: white;
        font-size: 1.75rem;
        font-weight: 700;
        margin: 0;
      }

      .result-item {
        margin-bottom: 32px;
      }

      .result-label {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.95rem;
        font-weight: 600;
        margin-bottom: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .result-value {
        color: white;
        font-size: 1.5rem;
        font-weight: 700;
      }

      .disease-name {
        padding: 12px 20px;
        background: rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        display: inline-block;
      }

      .confidence-container {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .confidence-bar-bg {
        flex: 1;
        height: 16px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        overflow: hidden;
      }

      .confidence-bar {
        height: 100%;
        background: linear-gradient(90deg, #10b981, #059669);
        border-radius: 10px;
        transition: width 1s ease-in-out;
      }

      .confidence-text {
        color: white;
        font-size: 1.25rem;
        font-weight: 700;
        min-width: 60px;
        text-align: right;
      }

      .risk-badge-container {
        display: inline-block;
      }

      .risk-badge {
        display: inline-block;
        padding: 12px 24px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1.125rem;
      }

      .risk-badge.high {
        background: rgba(239, 68, 68, 0.2);
        color: #ef4444;
        border: 2px solid rgba(239, 68, 68, 0.4);
      }

      .risk-badge.medium {
        background: rgba(245, 158, 11, 0.2);
        color: #f59e0b;
        border: 2px solid rgba(245, 158, 11, 0.4);
      }

      .risk-badge.low {
        background: rgba(16, 185, 129, 0.2);
        color: #10b981;
        border: 2px solid rgba(16, 185, 129, 0.4);
      }

      .treatment-section {
        background: rgba(255, 255, 255, 0.05);
        padding: 24px;
        border-radius: 16px;
      }

      .treatment-header {
        display: flex;
        align-items: center;
        gap: 12px;
        color: white;
        font-weight: 700;
        font-size: 1.125rem;
        margin-bottom: 16px;
      }

      .treatment-text {
        color: rgba(255, 255, 255, 0.8);
        font-size: 1rem;
        line-height: 1.6;
        margin: 0;
      }

      .result-actions {
        display: flex;
        gap: 16px;
        margin-top: 32px;
        padding-top: 32px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .btn-new-scan {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 16px 32px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 14px;
        color: white;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-new-scan:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
      }

      .btn-view-history {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px 32px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 14px;
        color: white;
        font-weight: 600;
        font-size: 1rem;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .btn-view-history:hover {
        background: rgba(255, 255, 255, 0.15);
        color: white;
        transform: translateY(-2px);
      }

      @media (max-width: 768px) {
        .detect-header h2 {
          font-size: 2rem;
        }

        .result-card {
          padding: 32px 24px;
        }

        .result-actions {
          flex-direction: column;
        }
      }
    </style>
    <!-- Floating AI Chatbot -->
    <div class="chatbot-container" id="chatbotContainer">
      <!-- Chat Button -->
      <!-- Chat Window -->
      <!-- Messages Area -->
      <!-- Input Field -->
      <!-- Quick Questions -->
    </div>
  </body>
</html>
